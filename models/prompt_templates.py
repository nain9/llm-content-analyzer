from entities.analysis_data import AnalysisData


class PromptTemplates:
	"""Шаблоны промптов для взаимодействия с моделями."""

	@staticmethod
	def audience_reaction(analysis_data: AnalysisData) -> str:
		return f"""
		Ты — эксперт по созданию контента для платформы "{analysis_data.platform}", с глубоким пониманием аудитории "{analysis_data.audience}" и формата блога "{analysis_data.blog_type}".  
		Проанализируй пост и выдай критичный, но полезный разбор, который:
		
		- Учитывает специфику платформы (например, Telegram = глубина, Twitter = провокация),  
		- Подходит интересам и стилю аудитории,  
		- Помогает усилить конкретный блог.
		
		Прежде чем дать рекомендации, следуй логике пошагового анализа:
		
		1. Контекст:
		- Платформа: "{analysis_data.platform}"  
		- Аудитория: "{analysis_data.audience}"  
		- Цель поста: "{analysis_data.purpose}"  
		- Тип блога: "{analysis_data.blog_type}"  
		- Текст поста: ""{analysis_data.post_text}"
		
		2. Пример разбора:
		
		Платформа: Twitter  
		Аудитория: Предприниматели  
		Цель поста: Создать резонанс
		Тип блога: Личный блог
		Текст поста: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."  
		
		1. Комментарий пользователя: "Очередной гуру с дивана. Миллионером он стал в симуляторе, видимо."  
		2. Эмоции: Раздражение и скепсис — слишком обобщающее и токсичное заявление.  
		3. Обсуждения: Да, вызовет споры о возрасте и деньгах.  
		4. Вовлечённость: Высокая — провокация = репосты и гневные комментарии.  
		5. Сильные стороны: Провокационный тон, короткая фраза — идеально для Twitter.  
		6. Слабые стороны: Неочевидна ценность, может оттолкнуть часть ЦА.  
		7. Рекомендации:  
		- Уточнить, что это личный опыт, а не истина;  
		- Добавить провокационный, но самоироничный хэштег — усилит вовлечённость.
		
		Теперь, используя такой же формат и ход рассуждений, проанализируй этот пост. Структура ответа:
		
		1. Комментарий пользователя: Реалистичный отклик от типичного представителя ЦА.  
		2. Эмоции: Что чувствует читатель и почему (в терминах контекста и подачи).  
		3. Обсуждения: Какие споры или мысли может вызвать пост.  
		4. Вовлечённость: Есть ли стимул лайкать/репостить/комментировать — с объяснением.  
		5. Сильные стороны: Что работает хорошо — с опорой на ЦА и формат.  
		6. Слабые стороны: Конкретные недочёты — в аргументации, тоне, структуре.  
		7. Рекомендации:  
		- Адаптированы под платформу и стиль блога,  
		- Направлены на устранение выявленных слабых мест,  
		- Сохраняют релевантность для аудитории.
		
		Важно:  
		- Если пост не подходит под аудиторию или платформу — скажи это прямо.  
		- Избегай общих фраз ("нужно лучше подать идею").  
		- Будь критичен, но конструктивен.
		- Отвечай по каждому пункту одним-двумя предложениями, уложись в каждом пункте в 100-150 токенов и следуй примерам.
		"""

	@staticmethod
	def advanced_audience_reaction(analysis_data: AnalysisData) -> list:
		messages = []
		# Запрос для генерации комментария
		messages.append(f"""
		Ты — представитель аудитории "{analysis_data.audience}" на платформе "{analysis_data.platform}". 
		Формат блога: "{analysis_data.blog_type}". Цель автора: "{analysis_data.purpose}".
		Прочитай пост и сгенерируй реалистичный комментарий в ответ — эмоциональный, но типичный для такой аудитории.

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Комментарий: "Абсолютно согласен! Утренние пробежки — это заряд бодрости и гордость за себя!"

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Комментарий: "Очередной гуру с дивана. Миллионером он стал в симуляторе, видимо."

		Теперь сгенерируй комментарий к посту: "{analysis_data.post_text}"
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Комментарий: ".
		""")

		# Запрос для генерации эмоций от поста
		messages.append(f"""
		Ты — эксперт по анализу эмоций аудитории "{analysis_data.audience}" на платформе "{analysis_data.platform}". 
		Формат блога: "{analysis_data.blog_type}". Цель автора: "{analysis_data.purpose}".
		Оцени, какие эмоции вызывает этот пост, объясни, что триггерит аудиторию.

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Эмоции: Вдохновение и мотивация — пост вызывает желание действовать и создает позитивный настрой.

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Эмоции: Раздражение и скепсис — звучит как негативный приговор, это отталкивает.

		Проанализируй эмоции от этого поста: "{analysis_data.post_text}"		
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Эмоции: ".
		""")

		# Запрос для генерации потенциальных обсуждений в комментариях
		messages.append(f"""
		Ты — аналитик, который предсказывает обсуждения в комментариях. 
		Определи, какие темы или споры могут возникнуть среди аудитории "{analysis_data.audience}" на платформе "{analysis_data.platform}" после прочтения поста.
		Формат блога: "{analysis_data.blog_type}". Цель автора: "{analysis_data.purpose}".

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Обсуждения: Обмен историями о спорте и утренних ритуалах, обсуждение пользы пробежек.

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Обсуждения: Споры о возрасте, успехе, и токсичности таких утверждений.

		Какие обсуждения вызовет этот пост: "{analysis_data.post_text}"
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Обсуждения: ".
		""")

		# Запрос для генерации вовлеченности аудитории
		messages.append(f"""
		Ты — эксперт по вовлеченности в социальных сетях. 
		Проанализируй пост с учетом цели "{analysis_data.purpose}", формата "{analysis_data.blog_type}", платформы "{analysis_data.platform}" и интересов аудитории "{analysis_data.audience}".
		Оцени, насколько он вызывает желание комментировать, лайкать или репостить, и объясни почему.

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Вовлечённость: Высокая — пост вызывает желание делиться личным опытом и поддерживать позитивное обсуждение.

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Вовлечённость: Средняя — из-за провокации пост вызывает гнев, но может не стимулировать к конструктивному обсуждению.

		Оцени вовлечённость этого поста: "{analysis_data.post_text}"
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Вовлеченность: ".
		""")

		# Запрос для генерации сильных сторон поста
		messages.append(f"""
		Ты — эксперт по анализу контента. 
		Выдели сильные стороны этого поста, исходя из цели "{analysis_data.purpose}", формата блога "{analysis_data.blog_type}" и интересов аудитории "{analysis_data.audience}" на платформе "{analysis_data.platform}".

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Сильные стороны: Позитивный тон, доступность и личная мотивация — легко воспринимается и вызывает эмпатию.

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Сильные стороны: Провокационный, что может стимулировать реакции, но слишком агрессивный.

		Выдели сильные стороны этого поста: "{analysis_data.post_text}"
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Сильные стороны: ".
		""")

		# Запрос для генерации слабых сторон поста
		messages.append(f"""
		Ты — эксперт по анализу контента. 
		Найди слабые стороны поста: что мешает его восприятию, не даёт достичь цели "{analysis_data.purpose}", не соответствует формату "{analysis_data.blog_type}" или аудитории "{analysis_data.audience}" на платформе "{analysis_data.platform}".

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Слабые стороны: Может показаться банальным без контекста — не хватает уникальности.

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Слабые стороны: Токсичность и обобщение — такой подход может оттолкнуть аудиторию и вызвать недовольство.

		Найди слабые стороны этого поста: "{analysis_data.post_text}"
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Слабые стороны: ".
		""")

		# Запрос для генерации рекомендаций по улучшению поста
		messages.append(f"""
		Ты — эксперт по улучшению контента для платформы "{analysis_data.platform}". 
		Дай 1–2 чёткие рекомендации по улучшению поста, чтобы он стал более эффективным для аудитории "{analysis_data.audience}" и помог достичь цели "{analysis_data.purpose}" в формате блога "{analysis_data.blog_type}".

		Пример 1:
		Пост: "Знаете, чем круты утренние пробежки? Они настраивают на день и дают чувство достижения, даже если просто встать и выйти из дома."
		Рекомендации: Добавить конкретные советы или фото для усиления вовлечённости.

		Пример 2:
		Пост: "Если ты до 25 не заработал свой первый миллион — расслабься. Уже не заработаешь."
		Рекомендации: Избегать категоричности, переформулировать с акцентом на личный путь и поддержку.

		Дай рекомендации для этого поста: "{analysis_data.post_text}"
		Отвечай одним-двумя предложениями, уложись в 100-150 токенов и следуй примерам. Ответ начни с "Рекомендации: ".
		""")

		return messages

	@staticmethod
	def discusse_validation(message: str) -> str:
		return f"""
		Ты — ассистент, определяющий, связано ли сообщение с текущим диалогом.
	
		Проверь, относится ли оно хотя бы к одному из следующих пунктов:
		1. Анализ контента или поста (например: структура, стиль, эмоции, рекомендации и т.д.).
		2. Обсуждение или уточнение предыдущих ответов (например: "а если убрать пункт 2?", "можно переформулировать").
		3. Команды или инструкции по изменению анализа (например: "добавь пример", "измени тон").
		4. Логичное продолжение диалога, даже если напрямую не упоминается текст поста.
	
		Если сообщение связано хотя бы с одним из этих пунктов, ответь строго:
		"True"
	
		Если сообщение совершенно не относится к ним — например, начинается новый разговор или сменена тема — ответь строго:
		"False"
	
		Проверь это сообщение:
		"{message}"
		"""

	@staticmethod
	def discusse_response(message: str) -> str:
		return f"""
		Ты — ассистент, участвующий в экспертном обсуждении анализа поста. 
		Твоя задача — кратко, чётко и по существу ответить на следующий вопрос или реплику, сохраняя связность с предыдущим диалогом и аналитическим контекстом:
	
		"{message}"
	
		Сформулируй ответ объемом 200–300 токенов. Избегай лишней воды, сосредоточься на сути.
		"""